\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{codesetup}

\RequirePackage{etoolbox}               % logic % booleans


%%   +-----------+
%% ----- setup ----- %% -------------------------------------------------------
%%   +-----------+


%% declare options
% load my standard setup
\providebool{@normalmargins}
\boolfalse  {@normalmargins}
\DeclareOption{normalmargins}{ \booltrue{@normalmargins} }

%% process given options
\ProcessOptions\relax


%% ----- load packages

\RequirePackage{beramono}               % monospacefont supporting boldface
\RequirePackage{listings}               % listings
\RequirePackage[usenames,dvipsnames,svgnames,table]{xcolor} % colors!


%%   +--------------------+
%% ----- listings setup ----- %% ----------------------------------------------
%%   +--------------------+


%% ----- colors

\newcommand{\commentcolor}   {\color{Grey}} 
\newcommand{\identifiercolor}{}
\newcommand{\keywordcolor}   {\color{Blue}}
\newcommand{\numbercolor}    {\color{Cerulean}}
\newcommand{\stringcolor}    {\color{RedOrange}}


%% ----- listings setup

\lstset{ %
    %% border & numbering
    frame=tbrL,                               % adds a frame around the code
    numbers=left,                             % where to put the line-numbers; possible values are (none, left, right)
    numbersep=10pt,                           % how far the line-numbers are from the code
    numberstyle=\tiny\ttfamily\color{Black},  % the style that is used for the line-numbers
    rulecolor=\color{Black},                  % if not set, the frame-color may be changed on line-breaks within not-black text
    stepnumber=2,                             % the step between two line-numbers. If it's 1, each line will be numbered
    %% breaking
    breaklines=true,         % sets automatic line breaking
    breakatwhitespace=true,  % sets if automatic breaks should only happen at whitespace
    breakindent=2cm,         % indentation of broken lines
    %% caption
    captionpos=t,            % sets the caption-position to bottom
    %% charset
    extendedchars=true,      % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
    %% keywords
    deletekeywords={},       % if you want to delete keywords from the given language
    morekeywords={},         % if you want to add more keywords to the set
    %% spaces and tabs
    keepspaces=true,                     % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
    showspaces=false,                    % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
    showstringspaces=false,              % underline spaces within strings only
    showtabs=false,                      % show tabs within strings adding particular underscores
    tabsize=4,                           % sets default tabsize (number of spaces)
    %% style
    backgroundcolor=\color{White},       % choose the background color
    basicstyle=\footnotesize\ttfamily,   % general style settings
    commentstyle=\itshape\commentcolor,  % comment style
    identifierstyle=\identifiercolor,    % non-keyword style
    keywordstyle=\bfseries\keywordcolor, % keyword style
    stringstyle=\stringcolor,            % string literal style
}%

\notbool{@normalmargins}{
    \lstset{%
        %% margins -- negative means extend margins
        xleftmargin=-2cm,        % change in left margin
        xrightmargin=-2cm,       % change in right margin
    }
}{ }%


%% ----- styles

%% style coloring numbers -- the leading * makes it ignore strings and comments
%%                        -- format: {to replace}{replacement}{length}
\lstdefinestyle{numbercolor}{%
    literate=%
       *{0}{{{\numbercolor{0}}}}{1} {.0}{{{\numbercolor{.0}}}}{2} {0.}{{{\numbercolor{0.}}}}{2}%
        {1}{{{\numbercolor{1}}}}{1} {.1}{{{\numbercolor{.1}}}}{2} {1.}{{{\numbercolor{1.}}}}{2}%
        {2}{{{\numbercolor{2}}}}{1} {.2}{{{\numbercolor{.2}}}}{2} {2.}{{{\numbercolor{2.}}}}{2}%
        {3}{{{\numbercolor{3}}}}{1} {.3}{{{\numbercolor{.3}}}}{2} {3.}{{{\numbercolor{3.}}}}{2}%
        {4}{{{\numbercolor{4}}}}{1} {.4}{{{\numbercolor{.4}}}}{2} {4.}{{{\numbercolor{4.}}}}{2}%
        {5}{{{\numbercolor{5}}}}{1} {.5}{{{\numbercolor{.5}}}}{2} {5.}{{{\numbercolor{5.}}}}{2}%
        {6}{{{\numbercolor{6}}}}{1} {.6}{{{\numbercolor{.6}}}}{2} {6.}{{{\numbercolor{6.}}}}{2}%
        {7}{{{\numbercolor{7}}}}{1} {.7}{{{\numbercolor{.7}}}}{2} {7.}{{{\numbercolor{7.}}}}{2}%
        {8}{{{\numbercolor{8}}}}{1} {.8}{{{\numbercolor{.8}}}}{2} {8.}{{{\numbercolor{8.}}}}{2}%
        {9}{{{\numbercolor{9}}}}{1} {.9}{{{\numbercolor{.9}}}}{2} {9.}{{{\numbercolor{9.}}}}{2}%
        %%
        {\ }{{{ }}}{1}% handle space correct
}%

\endinput

